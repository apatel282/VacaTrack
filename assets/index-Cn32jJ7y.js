var ue=Object.defineProperty;var be=(s,t,r)=>t in s?ue(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r;var G=(s,t,r)=>be(s,typeof t!="symbol"?t+"":t,r);import{r as he,a as ge,g as pe}from"./vendor-react-BRY8hXab.js";import{r as x,S as ae,T as z,C as Y,a as fe,P as ve,b as je,c as ye,d as ke,X as re,e as Ne,M as we,f as Se,g as De,L as _e,h as Me,i as Ee,R as Pe}from"./vendor-ui-Bx0CoKBj.js";import{c as Ce}from"./vendor-supabase-CIvuJI4W.js";import{e as Te,p as w,i as A,s as F,a as se,m as Ae,b as Oe,c as J,d as W,f as S,g as U,h as R,j as ne,k as K,l as Ie,n as $,o as Re}from"./vendor-date-DcKgVCou.js";import{R as $e,P as Le,a as qe,C as Fe}from"./vendor-charts-BAy86pmT.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function r(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(n){if(n.ep)return;n.ep=!0;const o=r(n);fetch(n.href,o)}})();var V={exports:{}},O={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var X;function Ue(){if(X)return O;X=1;var s=he(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,n=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function c(l,u,b){var g,p={},f=null,j=null;b!==void 0&&(f=""+b),u.key!==void 0&&(f=""+u.key),u.ref!==void 0&&(j=u.ref);for(g in u)a.call(u,g)&&!o.hasOwnProperty(g)&&(p[g]=u[g]);if(l&&l.defaultProps)for(g in u=l.defaultProps,u)p[g]===void 0&&(p[g]=u[g]);return{$$typeof:t,type:l,key:f,ref:j,props:p,_owner:n.current}}return O.Fragment=r,O.jsx=c,O.jsxs=c,O}var H;function Be(){return H||(H=1,V.exports=Ue()),V.exports}var e=Be(),L={},Q;function Ve(){if(Q)return L;Q=1;var s=ge();return L.createRoot=s.createRoot,L.hydrateRoot=s.hydrateRoot,L}var ze=Ve();const Ye=pe(ze),oe={periodStart:null,periodEnd:null,annualAllotment:0,theme:"system"};class Je{constructor(t,r){G(this,"supabase");this.supabase=Ce(t,r)}async loadSettings(){const{data:t,error:r}=await this.supabase.from("settings").select("*").limit(1).single();return r||!t?null:{periodStart:t.period_start_month&&t.period_start_year?{month:t.period_start_month,year:t.period_start_year}:null,periodEnd:t.period_end_month&&t.period_end_year?{month:t.period_end_month,year:t.period_end_year}:null,annualAllotment:t.annual_allotment||0,theme:t.theme||"system"}}async saveSettings(t){var n,o,c,l;const{data:r}=await this.supabase.from("settings").select("id").limit(1).single(),a={period_start_month:((n=t.periodStart)==null?void 0:n.month)||null,period_start_year:((o=t.periodStart)==null?void 0:o.year)||null,period_end_month:((c=t.periodEnd)==null?void 0:c.month)||null,period_end_year:((l=t.periodEnd)==null?void 0:l.year)||null,annual_allotment:t.annualAllotment,theme:t.theme,updated_at:new Date().toISOString()};r!=null&&r.id?await this.supabase.from("settings").update(a).eq("id",r.id):await this.supabase.from("settings").insert(a)}async loadEntries(){const{data:t,error:r}=await this.supabase.from("pto_entries").select("*").order("start_date",{ascending:!1});return r||!t?[]:t.map(a=>({id:a.id,type:a.type,startDate:a.start_date,endDate:a.end_date,notes:a.notes||"",createdAt:a.created_at,updatedAt:a.updated_at}))}async addEntry(t){const{error:r}=await this.supabase.from("pto_entries").insert({id:t.id,type:t.type,start_date:t.startDate,end_date:t.endDate,notes:t.notes,created_at:t.createdAt,updated_at:t.updatedAt});if(r)throw console.error("Supabase addEntry error:",r),r}async updateEntry(t){const{error:r}=await this.supabase.from("pto_entries").update({type:t.type,start_date:t.startDate,end_date:t.endDate,notes:t.notes,updated_at:new Date().toISOString()}).eq("id",t.id);if(r)throw console.error("Supabase updateEntry error:",r),r}async deleteEntry(t){const{error:r}=await this.supabase.from("pto_entries").delete().eq("id",t);if(r)throw console.error("Supabase deleteEntry error:",r),r}async exportAll(){const t=await this.loadSettings(),r=await this.loadEntries();return{settings:t||oe,entries:r}}async importAll(t){if(await this.saveSettings(t.settings),await this.supabase.from("pto_entries").delete().neq("id",""),t.entries.length>0){const r=t.entries.map(a=>({id:a.id,type:a.type,start_date:a.startDate,end_date:a.endDate,notes:a.notes,created_at:a.createdAt,updated_at:a.updatedAt}));await this.supabase.from("pto_entries").insert(r)}}}const We="https://ucxliehvfrkkgsjrmvgb.supabase.co",Ge="sb_publishable_XGNZUwT722ru4LtqKo84Og_B8NXFn0H",P=new Je(We,Ge);function de(s,t){const r=w(s),a=w(t);return A(r,a)?0:J({start:r,end:a}).filter(o=>!W(o)).length}function B(s){if(!s.periodStart||!s.periodEnd)return null;const t=F(new Date(s.periodStart.year,s.periodStart.month-1,1)),r=se(new Date(s.periodEnd.year,s.periodEnd.month-1,1));return{start:t,end:r}}function le(s,t,r,a){const n=w(s),o=w(t),c=Ae([n,r]),l=Oe([o,a]);return A(c,l)?0:J({start:c,end:l}).filter(b=>!W(b)).length}function ce(s,t){const r=B(t);if(!r)return{allotted:t.annualAllotment,used:0,planned:0,remaining:t.annualAllotment,projectedRemaining:t.annualAllotment};let a=0,n=0;for(const l of s){const u=le(l.startDate,l.endDate,r.start,r.end);l.type==="used"?a+=u:n+=u}const o=t.annualAllotment-a,c=t.annualAllotment-a-n;return{allotted:t.annualAllotment,used:a,planned:n,remaining:o,projectedRemaining:c}}function ie(s,t=new Date){if(s.type!=="planned")return s;const r=Te(w(s.endDate));return A(t,r)?{...s,type:"used",updatedAt:new Date().toISOString()}:s}function Z(s,t=new Date){const r=[];return{entries:s.map(n=>{const o=ie(n,t);return o!==n&&r.push(o),o}),updated:r}}function Ke(s,t){const r=w(s.startDate),a=w(s.endDate);return t.filter(n=>{if(s.id&&n.id===s.id)return!1;const o=w(n.startDate),c=w(n.endDate);return(U(r,c)||r.getTime()===c.getTime())&&(A(a,o)||a.getTime()===o.getTime())})}function Xe(s){if(!s.periodStart||!s.periodEnd)return"No period set";const t=new Date(s.periodStart.year,s.periodStart.month-1,1),r=new Date(s.periodEnd.year,s.periodEnd.month-1,1),a=S(t,"MMM yyyy"),n=S(r,"MMM yyyy");return`${a} – ${n}`}function He(s){const t=B(s);if(!t)return[];const r=[];let a=t.start;for(;U(a,t.end)||R(a,t.end);)r.push(F(a)),a=ne(a,1);return r}function Qe(s,t){const r=w(s),a=w(t);return s===t?S(r,"MMM d, yyyy"):R(r,a)&&K(r,a)?`${S(r,"MMM d")} – ${S(a,"d, yyyy")}`:K(r,a)?`${S(r,"MMM d")} – ${S(a,"MMM d, yyyy")}`:`${S(r,"MMM d, yyyy")} – ${S(a,"MMM d, yyyy")}`}function Ze(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}function et(s){const[t,r]=x.useState(!1);return x.useEffect(()=>{const a=document.documentElement;if(s==="dark")a.classList.add("dark"),r(!0);else if(s==="light")a.classList.remove("dark"),r(!1);else{const n=window.matchMedia("(prefers-color-scheme: dark)"),o=c=>{c.matches?(a.classList.add("dark"),r(!0)):(a.classList.remove("dark"),r(!1))};return o(n),n.addEventListener("change",o),()=>n.removeEventListener("change",o)}},[s]),t}function tt({settings:s,onOpenSettings:t}){return e.jsx("header",{className:"sticky top-0 z-40 bg-bg-100/80 dark:bg-bg-100/80 backdrop-blur-md border-b border-bg-300 dark:border-bg-300",style:{paddingTop:"env(safe-area-inset-top)"},children:e.jsx("div",{className:"max-w-lg mx-auto px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-text-100 dark:text-text-100",children:"VacaTrack"}),e.jsx("p",{className:"text-sm text-text-200 dark:text-text-100/70",children:Xe(s)})]}),e.jsx("button",{onClick:t,className:"p-2 rounded-full hover:bg-bg-200 dark:hover:bg-bg-300 transition-colors","aria-label":"Settings",title:"Settings",children:e.jsx(ae,{className:"w-5 h-5 text-text-200 dark:text-text-200"})})]})})})}function at({allotted:s,used:t,planned:r,remaining:a,projectedRemaining:n}){const o=n<0,c=[{name:"Used",value:Math.max(0,t),color:"var(--accent-200)"},{name:"Planned",value:Math.max(0,r),color:"var(--accent-100)"},{name:"Available",value:Math.max(0,n),color:"var(--bg-300)"}].filter(l=>l.value>0);return o&&(c.length=0,c.push({name:"Used",value:t,color:"var(--accent-200)"},{name:"Planned",value:r,color:"var(--accent-100)"})),e.jsxs("div",{className:"bg-bg-100 dark:bg-bg-100 rounded-2xl p-4 shadow-sm border border-bg-300 dark:border-bg-300",children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsxs("div",{className:"relative w-40 h-40",children:[e.jsx($e,{width:"100%",height:"100%",children:e.jsx(Le,{children:e.jsx(qe,{data:c,cx:"50%",cy:"50%",innerRadius:45,outerRadius:65,paddingAngle:2,dataKey:"value",strokeWidth:0,children:c.map((l,u)=>e.jsx(Fe,{fill:l.color},`cell-${u}`))})})}),e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[e.jsx("span",{className:`text-2xl font-bold ${o?"text-red-500":"text-text-100 dark:text-text-100"}`,children:n}),e.jsx("span",{className:"text-sm text-text-200 dark:text-text-100/70",children:"projected"})]})]})}),o&&e.jsxs("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg flex items-start gap-2",children:[e.jsx(z,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),e.jsxs("p",{className:"text-sm text-red-700 dark:text-red-300",children:["You've exceeded your PTO allotment by ",Math.abs(n)," day",Math.abs(n)!==1?"s":"","."]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(q,{label:"Allotted",value:s,color:"text-text-100"}),e.jsx(q,{label:"Used",value:t,color:"text-accent-200"}),e.jsx(q,{label:"Planned",value:r,color:"text-accent-100 dark:text-accent-100"}),e.jsx(q,{label:"Remaining",value:a,color:a<0?"text-red-500":"text-text-100"})]})]})}function q({label:s,value:t,color:r}){return e.jsxs("div",{className:"bg-bg-200 dark:bg-bg-200 rounded-xl p-3 text-center",children:[e.jsx("p",{className:"text-xs text-text-200 dark:text-text-100/70 mb-1",children:s}),e.jsx("p",{className:`text-xl font-semibold ${r}`,children:t})]})}function rt({entries:s,onEdit:t,onDelete:r}){const a=[...s].sort((n,o)=>o.startDate.localeCompare(n.startDate));return a.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Y,{className:"w-12 h-12 text-bg-300 dark:text-bg-300 mx-auto mb-3"}),e.jsx("p",{className:"text-text-200 dark:text-text-200",children:"No PTO entries yet"}),e.jsx("p",{className:"text-sm text-bg-300 dark:text-bg-300 mt-1",children:"Add your first entry above"})]}):e.jsx("div",{className:"space-y-2",children:a.map(n=>e.jsx(st,{entry:n,onEdit:()=>t(n),onDelete:()=>r(n)},n.id))})}function st({entry:s,onEdit:t,onDelete:r}){const a=de(s.startDate,s.endDate),n=s.type==="used";return e.jsx("div",{className:"bg-bg-100 dark:bg-bg-100 rounded-xl p-4 shadow-sm border border-bg-300 dark:border-bg-300",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-start gap-3 min-w-0 flex-1",children:[e.jsx("div",{className:`p-2 rounded-lg flex-shrink-0 ${n?"bg-primary-100 dark:bg-primary-500/30":"bg-bg-200 dark:bg-bg-300"}`,children:n?e.jsx(fe,{className:"w-5 h-5 text-accent-200 dark:text-accent-200"}):e.jsx(Y,{className:"w-5 h-5 text-text-200 dark:text-text-200"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-xs font-medium px-2 py-0.5 rounded-full ${n?"bg-accent-200 text-white dark:bg-accent-200 dark:text-white":"bg-bg-200 text-text-200 dark:bg-bg-300 dark:text-text-100"}`,children:n?"Used":"Planned"}),e.jsxs("span",{className:"text-sm font-semibold text-text-100",children:[a," day",a!==1?"s":""]})]}),e.jsx("p",{className:"text-sm text-text-200 dark:text-text-200 mt-1",children:Qe(s.startDate,s.endDate)}),s.notes&&e.jsx("p",{className:"text-sm text-text-200 dark:text-text-200 mt-1 truncate opacity-70",children:s.notes})]})]}),e.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[e.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-bg-200 dark:hover:bg-bg-300 transition-colors","aria-label":"Edit entry",children:e.jsx(ve,{className:"w-4 h-4 text-text-200 dark:text-text-200"})}),e.jsx("button",{onClick:r,className:"p-2 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/30 transition-colors","aria-label":"Delete entry",children:e.jsx(je,{className:"w-4 h-4 text-text-200 dark:text-text-200 hover:text-red-500"})})]})]})})}function nt({entries:s,settings:t,onEdit:r}){const a=He(t),n=B(t),[o,c]=x.useState(()=>{if(a.length===0)return new Date;const m=F(new Date);return a.find(v=>R(v,m))||a[0]}),l=x.useMemo(()=>a.length===0?!1:!R(o,a[0]),[o,a]),u=x.useMemo(()=>a.length===0?!1:!R(o,a[a.length-1]),[o,a]),b=()=>{l&&c(Re(o))},g=()=>{u&&c(ne(o,1))},p=x.useMemo(()=>{const m=F(o),h=se(o);return J({start:m,end:h})},[o]),f=x.useMemo(()=>{const m=Ie(p[0]);return Array(m).fill(null)},[p]),j=m=>s.filter(h=>{const v=w(h.startDate),y=w(h.endDate);return($(m,v)||A(m,v))&&($(m,y)||U(m,y))});return!n||a.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Y,{className:"w-12 h-12 text-bg-300 dark:text-bg-300 mx-auto mb-3"}),e.jsx("p",{className:"text-text-200 dark:text-text-200",children:"No tracking period set"}),e.jsx("p",{className:"text-sm text-bg-300 dark:text-bg-300 mt-1",children:"Configure your period in Settings"})]}):e.jsxs("div",{className:"bg-bg-100 dark:bg-bg-100 rounded-2xl p-4 shadow-sm border border-bg-300 dark:border-bg-300",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("button",{onClick:b,disabled:!l,className:"p-2 rounded-lg hover:bg-bg-200 dark:hover:bg-bg-300 disabled:opacity-30 disabled:cursor-not-allowed transition-colors","aria-label":"Previous month",children:e.jsx(ye,{className:"w-5 h-5 text-text-100"})}),e.jsx("h3",{className:"text-lg font-semibold text-text-100 dark:text-text-100",children:S(o,"MMMM yyyy")}),e.jsx("button",{onClick:g,disabled:!u,className:"p-2 rounded-lg hover:bg-bg-200 dark:hover:bg-bg-300 disabled:opacity-30 disabled:cursor-not-allowed transition-colors","aria-label":"Next month",children:e.jsx(ke,{className:"w-5 h-5 text-text-100"})})]}),e.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["S","M","T","W","T","F","S"].map((m,h)=>e.jsx("div",{className:"text-center text-xs font-medium text-text-200 dark:text-text-100/70 py-2",children:m},h))}),e.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[f.map((m,h)=>e.jsx("div",{className:"aspect-square"},`pad-${h}`)),p.map(m=>{const h=j(m),v=($(m,n.start)||A(m,n.start))&&($(m,n.end)||U(m,n.end)),y=W(m),D=h.some(E=>E.type==="used"),_=h.some(E=>E.type==="planned");return e.jsxs("button",{onClick:()=>{h.length===1&&r(h[0])},disabled:h.length===0,className:`
                aspect-square rounded-lg text-sm font-medium relative
                flex flex-col items-center justify-center
                transition-colors
                ${y?"text-text-200/50 dark:text-text-100/30":"text-text-100 dark:text-text-100"}
                ${v?"":"opacity-30"}
                ${h.length>0?"cursor-pointer hover:bg-bg-200 dark:hover:bg-bg-300":""}
                ${D?"bg-accent-200 text-white":""}
                ${_&&!D?"bg-accent-100 text-accent-200 dark:bg-accent-100/30 dark:text-accent-100":""}
              `,children:[e.jsx("span",{children:S(m,"d")}),h.length>0&&e.jsxs("div",{className:"flex gap-0.5 mt-0.5",children:[D&&e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-white dark:bg-white"}),_&&e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-accent-200"})]})]},m.toISOString())})]}),e.jsxs("div",{className:"flex items-center justify-center gap-4 mt-4 pt-4 border-t border-bg-300 dark:border-bg-300",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-accent-200"}),e.jsx("span",{className:"text-xs text-text-200 dark:text-text-100/70",children:"Used"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-accent-100"}),e.jsx("span",{className:"text-xs text-text-200 dark:text-text-100/70",children:"Planned"})]})]})]})}function xe({isOpen:s,onClose:t,title:r,children:a}){const n=x.useRef(null);return x.useEffect(()=>(s?(document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.width="100%"):(document.body.style.overflow="",document.body.style.position="",document.body.style.width=""),()=>{document.body.style.overflow="",document.body.style.position="",document.body.style.width=""}),[s]),x.useEffect(()=>{const o=c=>{c.key==="Escape"&&t()};if(s)return document.addEventListener("keydown",o),()=>document.removeEventListener("keydown",o)},[s,t]),s?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center",onClick:o=>{o.target===o.currentTarget&&t()},children:[e.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),e.jsxs("div",{ref:n,className:"relative w-full sm:max-w-md bg-bg-100 dark:bg-bg-100 rounded-t-2xl sm:rounded-2xl shadow-xl max-h-[90vh] overflow-hidden flex flex-col animate-slide-up sm:animate-fade-in",style:{paddingBottom:"env(safe-area-inset-bottom)"},children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-bg-300 dark:border-bg-300",children:[e.jsx("h2",{className:"text-lg font-semibold text-text-100 dark:text-text-100",children:r}),e.jsx("button",{onClick:t,className:"p-2 -mr-2 rounded-full hover:bg-bg-200 dark:hover:bg-bg-300 transition-colors","aria-label":"Close",children:e.jsx(re,{className:"w-5 h-5 text-text-200 dark:text-text-200"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:a})]})]}):null}function ot({isOpen:s,onClose:t,onSave:r,editingEntry:a,existingEntries:n,settings:o}){const c=S(new Date,"yyyy-MM-dd"),[l,u]=x.useState(c),[b,g]=x.useState(c),[p,f]=x.useState("planned"),[j,m]=x.useState("");x.useEffect(()=>{s&&(a?(u(a.startDate),g(a.endDate),f(a.type),m(a.notes)):(u(c),g(c),f("planned"),m("")))},[s,a,c]);const h=B(o),v=x.useMemo(()=>!l||!b?0:de(l,b),[l,b]),y=x.useMemo(()=>!l||!b||!h?v:le(l,b,h.start,h.end),[l,b,h,v]),D=x.useMemo(()=>!l||!b?[]:Ke({startDate:l,endDate:b,id:a==null?void 0:a.id},n),[l,b,a,n]),_=x.useMemo(()=>{const i={id:(a==null?void 0:a.id)||"temp",type:p,startDate:l,endDate:b,notes:"",createdAt:"",updatedAt:""},N=a?n.filter(M=>M.id!==a.id):n;return ce([...N,i],o).projectedRemaining},[l,b,p,a,n,o]),E=_<0,C=l&&b&&l<=b,T=C&&v>0,d=()=>{if(!T)return;const i=new Date().toISOString(),N={id:(a==null?void 0:a.id)||Ze(),type:p,startDate:l,endDate:b,notes:j.trim(),createdAt:(a==null?void 0:a.createdAt)||i,updatedAt:i};r(N),t()};return e.jsx(xe,{isOpen:s,onClose:t,title:a?"Edit PTO":"Add PTO",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-100 mb-2",children:"Type"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>f("planned"),className:`flex-1 py-2 px-4 rounded-lg border font-medium transition-colors ${p==="planned"?"border-accent-200 bg-accent-200 text-white":"border-bg-300 dark:border-bg-300 text-text-200 dark:text-text-200 hover:bg-bg-100 dark:hover:bg-bg-200"}`,children:"Planned"}),e.jsx("button",{onClick:()=>f("used"),className:`flex-1 py-2 px-4 rounded-lg border font-medium transition-colors ${p==="used"?"border-accent-200 bg-accent-200 text-white":"border-bg-300 dark:border-bg-300 text-text-200 dark:text-text-200 hover:bg-bg-100 dark:hover:bg-bg-200"}`,children:"Used"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-100 mb-2",children:"Start Date"}),e.jsx("input",{type:"date",value:l,onChange:i=>{u(i.target.value),i.target.value>b&&g(i.target.value)},className:"w-full px-3 py-2 rounded-lg border border-bg-300 dark:border-bg-300 bg-bg-100 dark:bg-bg-100 text-text-100 dark:text-text-100 focus:ring-2 focus:ring-accent-200 focus:border-accent-200"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-100 mb-2",children:"End Date"}),e.jsx("input",{type:"date",value:b,min:l,onChange:i=>g(i.target.value),className:"w-full px-3 py-2 rounded-lg border border-bg-300 dark:border-bg-300 bg-bg-100 dark:bg-bg-100 text-text-100 dark:text-text-100 focus:ring-2 focus:ring-accent-200 focus:border-accent-200"})]})]}),C&&e.jsxs("div",{className:"bg-bg-200 dark:bg-bg-200 rounded-lg p-3 text-center",children:[e.jsx("span",{className:"text-2xl font-bold text-accent-200 dark:text-accent-200",children:y}),e.jsxs("span",{className:"text-text-200 dark:text-text-200 ml-2",children:["PTO day",y!==1?"s":"",y!==v&&e.jsxs("span",{className:"text-xs",children:[" (",v," total, ",y," in period)"]})]})]}),D.length>0&&e.jsxs("div",{className:"p-3 bg-amber-50 dark:bg-amber-900/30 border border-amber-200 dark:border-amber-800 rounded-lg flex items-start gap-2",children:[e.jsx(z,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),e.jsxs("p",{className:"text-sm text-amber-700 dark:text-amber-300",children:["This overlaps with ",D.length," existing entr",D.length===1?"y":"ies","."]})]}),E&&e.jsxs("div",{className:"p-3 bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg flex items-start gap-2",children:[e.jsx(z,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),e.jsxs("p",{className:"text-sm text-red-700 dark:text-red-300",children:["This will exceed your allotment by ",Math.abs(_)," day",Math.abs(_)!==1?"s":"","."]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-100 mb-2",children:"Notes (optional)"}),e.jsx("textarea",{value:j,onChange:i=>m(i.target.value),rows:2,className:"w-full px-3 py-2 rounded-lg border border-bg-300 dark:border-bg-300 bg-bg-100 dark:bg-bg-100 text-text-100 dark:text-text-100 focus:ring-2 focus:ring-accent-200 focus:border-accent-200 resize-none",placeholder:"e.g., Summer vacation"})]}),e.jsx("button",{onClick:d,disabled:!T,className:"w-full py-3 px-4 bg-accent-200 hover:bg-accent-200/90 disabled:bg-bg-300 dark:disabled:bg-bg-300 text-white font-medium rounded-lg transition-colors disabled:cursor-not-allowed",children:a?"Save Changes":"Add PTO"})]})})}const ee=["January","February","March","April","May","June","July","August","September","October","November","December"],I=new Date().getFullYear(),te=Array.from({length:10},(s,t)=>I-3+t);function dt({isOpen:s,onClose:t,settings:r,onSave:a}){var _,E,C,T;const[n,o]=x.useState(((_=r.periodStart)==null?void 0:_.month)||1),[c,l]=x.useState(((E=r.periodStart)==null?void 0:E.year)||I),[u,b]=x.useState(((C=r.periodEnd)==null?void 0:C.month)||12),[g,p]=x.useState(((T=r.periodEnd)==null?void 0:T.year)||I),[f,j]=x.useState(r.annualAllotment.toString()),[m,h]=x.useState(r.theme);x.useEffect(()=>{var d,i,N,k;s&&(o(((d=r.periodStart)==null?void 0:d.month)||1),l(((i=r.periodStart)==null?void 0:i.year)||I),b(((N=r.periodEnd)==null?void 0:N.month)||12),p(((k=r.periodEnd)==null?void 0:k.year)||I),j(r.annualAllotment.toString()),h(r.theme))},[s,r]);const v=()=>{const d={periodStart:{month:n,year:c},periodEnd:{month:u,year:g},annualAllotment:parseInt(f)||0,theme:m};a(d),t()},y=()=>{const d=new Date(c,n-1),i=new Date(g,u-1);return d<=i},D=y()&&parseInt(f)>0;return e.jsx(xe,{isOpen:s,onClose:t,title:"Settings",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-100 mb-2",children:"Tracking Period Start"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("select",{value:n,onChange:d=>o(parseInt(d.target.value)),className:"flex-1 px-3 py-2 rounded-lg border border-bg-300 dark:border-bg-300 bg-bg-100 dark:bg-bg-100 text-text-100 dark:text-text-100 focus:ring-2 focus:ring-accent-200 focus:border-accent-200",children:ee.map((d,i)=>e.jsx("option",{value:i+1,children:d},d))}),e.jsx("select",{value:c,onChange:d=>l(parseInt(d.target.value)),className:"w-24 px-3 py-2 rounded-lg border border-bg-300 dark:border-bg-300 bg-bg-100 dark:bg-bg-100 text-text-100 dark:text-text-100 focus:ring-2 focus:ring-accent-200 focus:border-accent-200",children:te.map(d=>e.jsx("option",{value:d,children:d},d))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-100 mb-2",children:"Tracking Period End"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("select",{value:u,onChange:d=>b(parseInt(d.target.value)),className:"flex-1 px-3 py-2 rounded-lg border border-bg-300 dark:border-bg-300 bg-bg-100 dark:bg-bg-100 text-text-100 dark:text-text-100 focus:ring-2 focus:ring-accent-200 focus:border-accent-200",children:ee.map((d,i)=>e.jsx("option",{value:i+1,children:d},d))}),e.jsx("select",{value:g,onChange:d=>p(parseInt(d.target.value)),className:"w-24 px-3 py-2 rounded-lg border border-bg-300 dark:border-bg-300 bg-bg-100 dark:bg-bg-100 text-text-100 dark:text-text-100 focus:ring-2 focus:ring-accent-200 focus:border-accent-200",children:te.map(d=>e.jsx("option",{value:d,children:d},d))})]}),!y()&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:"End date must be after start date"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-100 mb-2",children:"Annual PTO Allotment (days)"}),e.jsx("input",{type:"number",min:"0",max:"365",value:f,onChange:d=>j(d.target.value),className:"w-full px-3 py-2 rounded-lg border border-bg-300 dark:border-bg-300 bg-bg-100 dark:bg-bg-100 text-text-100 dark:text-text-100 focus:ring-2 focus:ring-accent-200 focus:border-accent-200",placeholder:"e.g., 20"}),parseInt(f)<=0&&e.jsx("p",{className:"mt-1 text-sm text-amber-500",children:"Please enter your PTO allotment"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-100 mb-2",children:"Theme"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>h("light"),className:`flex-1 flex items-center justify-center gap-2 px-3 py-2 rounded-lg border transition-colors ${m==="light"?"border-accent-200 bg-accent-200 text-white":"border-bg-300 dark:border-bg-300 text-text-200 dark:text-text-200 hover:bg-bg-100 dark:hover:bg-bg-200"}`,children:[e.jsx(Ne,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Light"})]}),e.jsxs("button",{onClick:()=>h("dark"),className:`flex-1 flex items-center justify-center gap-2 px-3 py-2 rounded-lg border transition-colors ${m==="dark"?"border-accent-200 bg-accent-200 text-white":"border-bg-300 dark:border-bg-300 text-text-200 dark:text-text-200 hover:bg-bg-100 dark:hover:bg-bg-200"}`,children:[e.jsx(we,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Dark"})]}),e.jsxs("button",{onClick:()=>h("system"),className:`flex-1 flex items-center justify-center gap-2 px-3 py-2 rounded-lg border transition-colors ${m==="system"?"border-accent-200 bg-accent-200 text-white":"border-bg-300 dark:border-bg-300 text-text-200 dark:text-text-200 hover:bg-bg-100 dark:hover:bg-bg-200"}`,children:[e.jsx(Se,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Auto"})]})]})]}),e.jsx("button",{onClick:v,disabled:!D,className:"w-full py-3 px-4 bg-accent-200 hover:bg-accent-200/90 disabled:bg-bg-300 dark:disabled:bg-bg-300 text-white font-medium rounded-lg transition-colors disabled:cursor-not-allowed",children:"Save Settings"})]})})}function lt({hasSettings:s,onOpenSettings:t}){return s?null:e.jsxs("div",{className:"text-center py-12 px-4",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-amber-100 dark:bg-amber-900/30 mb-4",children:e.jsx(De,{className:"w-8 h-8 text-amber-600 dark:text-amber-400"})}),e.jsx("h2",{className:"text-lg font-semibold text-text-100 dark:text-text-100 mb-2",children:"Welcome to VacaTrack"}),e.jsx("p",{className:"text-text-200 dark:text-text-200 mb-6 max-w-sm mx-auto",children:"Set up your tracking period and PTO allotment to get started."}),e.jsxs("button",{onClick:t,className:"inline-flex items-center gap-2 px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white font-medium rounded-lg transition-colors",children:[e.jsx(ae,{className:"w-4 h-4"}),"Open Settings"]})]})}function ct({message:s,action:t,duration:r=1e4,onClose:a}){const[n,o]=x.useState(!0),[c,l]=x.useState(100);x.useEffect(()=>{const g=Date.now()+r,p=setInterval(()=>{const f=Date.now(),m=(g-f)/r*100;m<=0?(clearInterval(p),o(!1),setTimeout(a,300)):l(m)},50);return()=>clearInterval(p)},[r,a]);const u=()=>{t==null||t.onClick(),o(!1),setTimeout(a,300)};return e.jsxs("div",{className:`fixed bottom-4 left-4 right-4 sm:left-auto sm:right-4 sm:w-80 bg-bg-300 dark:bg-bg-300 text-text-100 dark:text-text-100 rounded-lg shadow-lg overflow-hidden transition-all duration-300 z-50 ${n?"opacity-100 translate-y-0":"opacity-0 translate-y-4"}`,style:{paddingBottom:"env(safe-area-inset-bottom)"},children:[e.jsxs("div",{className:"flex items-center justify-between p-3",children:[e.jsx("span",{className:"text-sm",children:s}),e.jsxs("div",{className:"flex items-center gap-2 ml-3",children:[t&&e.jsx("button",{onClick:u,className:"text-sm font-medium text-accent-200 dark:text-accent-200 hover:opacity-80 transition-colors",children:t.label}),e.jsx("button",{onClick:()=>{o(!1),setTimeout(a,300)},className:"p-1 hover:bg-bg-200 dark:hover:bg-bg-300 rounded transition-colors",children:e.jsx(re,{className:"w-4 h-4"})})]})]}),e.jsx("div",{className:"h-1 bg-bg-200 dark:bg-bg-200",children:e.jsx("div",{className:"h-full bg-primary-500 transition-all duration-50",style:{width:`${c}%`}})})]})}function it(){const[s,t]=x.useState(oe),[r,a]=x.useState([]),[n,o]=x.useState(!0),[c,l]=x.useState("list"),[u,b]=x.useState(!1),[g,p]=x.useState(!1),[f,j]=x.useState(null),[m,h]=x.useState(null);et(s.theme),x.useEffect(()=>{async function d(){try{const[i,N]=await Promise.all([P.loadSettings(),P.loadEntries()]);i&&t(i);const{entries:k,updated:M}=Z(N);M.length>0&&await Promise.all(M.map(me=>P.updateEntry(me))),a(k)}catch(i){console.error("Failed to load data:",i)}finally{o(!1)}}d()},[]),x.useEffect(()=>{if(n)return;const d=setInterval(()=>{a(i=>{const{entries:N,updated:k}=Z(i);return k.length>0&&Promise.all(k.map(M=>P.updateEntry(M))).catch(M=>{console.error("Failed to update auto-converted entries:",M)}),N})},3600*1e3);return()=>clearInterval(d)},[n]);const v=s.periodStart&&s.periodEnd&&s.annualAllotment>0,y=ce(r,s),D=async d=>{t(d),await P.saveSettings(d)},_=async d=>{const i=ie(d);r.some(k=>k.id===i.id)?(await P.updateEntry(i),a(k=>k.map(M=>M.id===i.id?i:M))):(await P.addEntry(i),a(k=>[...k,i]))},E=async d=>{a(i=>i.filter(N=>N.id!==d.id)),await P.deleteEntry(d.id),h({message:"PTO entry deleted",action:{label:"Undo",onClick:async()=>{await P.addEntry(d),a(i=>[...i,d])}}})},C=d=>{j(d),p(!0)},T=()=>{p(!1),j(null)};return n?e.jsx("div",{className:"min-h-screen bg-bg-200 dark:bg-bg-100 flex items-center justify-center",children:e.jsx("div",{className:"w-8 h-8 border-4 border-primary-500 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"min-h-screen bg-bg-200 dark:bg-bg-100",children:[e.jsx(tt,{settings:s,onOpenSettings:()=>b(!0)}),e.jsx("main",{className:"max-w-lg mx-auto px-4 py-4 pb-24",children:v?e.jsxs("div",{className:"space-y-4",children:[e.jsx(at,{...y}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>l("list"),className:`flex-1 flex items-center justify-center gap-2 py-2 px-4 rounded-lg border font-medium transition-colors ${c==="list"?"border-accent-200 bg-accent-200 text-white":"border-bg-300 dark:border-bg-300 text-text-200 dark:text-text-200 hover:bg-bg-100 dark:hover:bg-bg-200"}`,children:[e.jsx(_e,{className:"w-4 h-4"}),"List"]}),e.jsxs("button",{onClick:()=>l("calendar"),className:`flex-1 flex items-center justify-center gap-2 py-2 px-4 rounded-lg border font-medium transition-colors ${c==="calendar"?"border-accent-200 bg-accent-200 text-white":"border-bg-300 dark:border-bg-300 text-text-200 dark:text-text-200 hover:bg-bg-100 dark:hover:bg-bg-200"}`,children:[e.jsx(Me,{className:"w-4 h-4"}),"Calendar"]})]}),c==="list"?e.jsx(rt,{entries:r,onEdit:C,onDelete:E}):e.jsx(nt,{entries:r,settings:s,onEdit:C})]}):e.jsx(lt,{hasSettings:!1,onOpenSettings:()=>b(!0)})}),v&&e.jsx("button",{onClick:()=>p(!0),className:"fixed bottom-6 right-6 w-14 h-14 bg-primary-600 hover:bg-primary-700 text-white rounded-full shadow-lg flex items-center justify-center transition-colors",style:{marginBottom:"env(safe-area-inset-bottom)"},"aria-label":"Add PTO entry",children:e.jsx(Ee,{className:"w-6 h-6"})}),e.jsx(dt,{isOpen:u,onClose:()=>b(!1),settings:s,onSave:D}),e.jsx(ot,{isOpen:g,onClose:T,onSave:_,editingEntry:f,existingEntries:r,settings:s}),m&&e.jsx(ct,{message:m.message,action:m.action,onClose:()=>h(null)})]})}Ye.createRoot(document.getElementById("root")).render(e.jsx(Pe.StrictMode,{children:e.jsx(it,{})}));
